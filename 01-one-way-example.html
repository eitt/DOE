
<!DOCTYPE html>


<html lang="en" data-content_root="./" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>ANOVA One-way: An Illustrative example &#8212; ViDoe - Visualizing Design of Experiments</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="_static/styles/theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="_static/styles/bootstrap.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
<link href="_static/styles/pydata-sphinx-theme.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />

  
  <link href="_static/vendor/fontawesome/6.5.1/css/all.min.css?digest=8d27b9dea8ad943066ae" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="_static/vendor/fontawesome/6.5.1/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="_static/styles/sphinx-book-theme.css?v=384b581d" />
    <link rel="stylesheet" type="text/css" href="_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css?v=be8a1c11" />
    <link rel="stylesheet" type="text/css" href="_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="_static/design-style.1e8bd061cd6da7fc9cf755528e8ffc24.min.css?v=0a3b3ea7" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae" />
<link rel="preload" as="script" href="_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae" />
  <script src="_static/vendor/fontawesome/6.5.1/js/all.min.js?digest=8d27b9dea8ad943066ae"></script>

    <script src="_static/documentation_options.js?v=9eb32ce0"></script>
    <script src="_static/doctools.js?v=888ff710"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="_static/copybutton.js?v=f281be69"></script>
    <script src="_static/scripts/sphinx-book-theme.js?v=efea14e4"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="_static/togglebutton.js?v=4a39c7ea"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="_static/design-tabs.js?v=36754332"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = '01-one-way-example';</script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Markdown Files" href="02-markdown.html" />
    <link rel="prev" title="Explaining the Python Code" href="01-one-way-anova.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="en"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a id="pst-skip-link" class="skip-link" href="#main-content">Skip to main content</a>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>
    Back to top
  </button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <header class="bd-header navbar navbar-expand-lg bd-navbar">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  

<a class="navbar-brand logo" href="intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="_static/INGENIERÍA-INDUSTRIAL_LOGO.png" class="logo__image only-light" alt="ViDoe - Visualizing Design of Experiments - Home"/>
    <script>document.write(`<img src="_static/INGENIERÍA-INDUSTRIAL_LOGO.png" class="logo__image only-dark" alt="ViDoe - Visualizing Design of Experiments - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn navbar-btn search-button-field search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Search</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="intro.html">
                    Visualizing Design of Experiments with ViDoe: An Interactive Approach
                </a>
            </li>
        </ul>
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Extras</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="Bibliography.html">References</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://eitt.github.io/DOE/intro.html" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Source repository"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://eitt.github.io/DOE/intro.html/issues/new?title=Issue%20on%20page%20%2F01-one-way-example.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Open an issue"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="_sources/01-one-way-example.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm navbar-btn theme-switch-button" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch nav-link" data-mode="light"><i class="fa-solid fa-sun fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="dark"><i class="fa-solid fa-moon fa-lg"></i></span>
    <span class="theme-switch nav-link" data-mode="auto"><i class="fa-solid fa-circle-half-stroke fa-lg"></i></span>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>ANOVA One-way: An Illustrative example</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">ANOVA One-way: An Illustrative example</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#brief-description-of-the-test">Brief Description of the Test:</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data">Data:</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#statistical-analysis">Statistical Analysis:</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#brief-description-of-the-test-for-cortisol-levels">Brief Description of the Test for Cortisol Levels:</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#data-generation-in-python">Data generation in Python</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#example-solution">Example solution</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#task-1-generate-pre-and-post-treatment-cortisol-levels-for-each-group">Task 1. Generate pre- and post-treatment cortisol levels for each group.</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#interpretation">Interpretation:</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#task-2-perform-a-statistical-analysis-comparing-the-change-in-cortisol-levels-across-the-four-groups">Task 2. Perform a statistical analysis comparing the change in cortisol levels across the four groups.</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#model-summary">Model Summary:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#coefficients">Coefficients:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#diagnostics">Diagnostics:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#components">Components:</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#task-3-conduct-a-cost-effectiveness-analysis-based-on-the-change-in-cortisol-levels-and-the-cost-of-each-medicine">Task 3. Conduct a cost-effectiveness analysis based on the change in cortisol levels and the cost of each medicine.</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#average-change-in-cortisol-levels-cortisol">Average Change in Cortisol Levels (ΔCortisol):</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cost-per-unit-of-cortisol-reduction">Cost per Unit of Cortisol Reduction:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Interpretation:</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#note">Note.</a></li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <p><a name="01-one-way-example"></a></p>
<section class="tex2jax_ignore mathjax_ignore" id="anova-one-way-an-illustrative-example">
<h1>ANOVA One-way: An Illustrative example<a class="headerlink" href="#anova-one-way-an-illustrative-example" title="Link to this heading">#</a></h1>
<p><strong>Objective:</strong> To assess the effectiveness of three different stress-reducing medicines on lowering <a class="reference external" href="https://en.wikipedia.org/wiki/Cortisol">cortisol</a> levels in participants compared to a placebo. This study utilizes cortisol levels as a biomarker for stress to evaluate the medicinal effects.</p>
<p><strong>Groups:</strong></p>
<ul class="simple">
<li><p>Group 1: Medicine A</p></li>
<li><p>Group 2: Medicine B</p></li>
<li><p>Group 3: Medicine C</p></li>
<li><p>Group 4: Placebo (Control Group)</p></li>
</ul>
<p><strong>Participants:</strong> 32 participants, with 8 in each group. All population is homogeneous in gender, ethnicity, age, and extra control variables.</p>
<p><strong>Measurement:</strong> Baseline and post-treatment cortisol levels (measured in ng/mL).</p>
<p><strong>Assumptions:</strong></p>
<ul class="simple">
<li><p>Cortisol levels are measured before the start of the treatment (baseline) and after the treatment period, allowing for a direct comparison of stress level changes.</p></li>
<li><p>The cost of each medicine reflects its effectiveness in reducing cortisol levels, with higher costs for more effective medicines.</p></li>
</ul>
<p><strong>Tasks:</strong></p>
<ol class="arabic simple">
<li><p>Generate pre- and post-treatment cortisol levels for each group.</p></li>
<li><p>Perform a statistical analysis comparing the change in cortisol levels across the four groups.</p></li>
<li><p>Conduct a cost-effectiveness analysis based on the change in cortisol levels and the cost of each medicine.</p></li>
</ol>
<section id="brief-description-of-the-test">
<h2>Brief Description of the Test:<a class="headerlink" href="#brief-description-of-the-test" title="Link to this heading">#</a></h2>
<p>To assess the effectiveness of the treatments, we will calculate the difference in cortisol levels (Δcortisol) for each participant as the post-treatment level minus the baseline level. A negative Δcortisol indicates a reduction in cortisol levels, hence a reduction in stress. We will use an Analysis of Variance (ANOVA) to compare the means of Δcortisol across the four groups. If the ANOVA indicates significant differences, <a class="reference external" href="https://en.wikipedia.org/wiki/Post_hoc_analysis">post-hoc tests </a> (e.g., Tukey’s HSD) will be conducted to identify which groups differ from each other.</p>
</section>
<section id="data">
<h2>Data:<a class="headerlink" href="#data" title="Link to this heading">#</a></h2>
<p>We’ll assume the baseline cortisol levels are similar across all groups but expect a greater reduction in cortisol levels for the treatment groups compared to the placebo.</p>
<ul class="simple">
<li><p><strong>Placebo Group:</strong> Showed minimal changes in cortisol levels, with some variations reflecting the natural fluctuation of cortisol without significant intervention.</p></li>
<li><p><strong>Medicine A Group:</strong> Demonstrated a significant reduction in cortisol levels, with ΔCortisol values indicating a notable decrease, suggesting high effectiveness in reducing stress. This group is associated with the highest cost.</p></li>
<li><p><strong>Medicine B Group:</strong> Also showed a significant reduction in cortisol levels, similar to Medicine A, confirming its effectiveness. The cost is slightly lower than Medicine A, reflecting its comparative market positioning.</p></li>
<li><p><strong>Medicine C Group:</strong> Presented a moderate reduction in cortisol levels, more than the placebo but less than Medicines A and B, aligning with its positioning as a less expensive but moderately effective option.</p></li>
</ul>
</section>
<section id="statistical-analysis">
<h2>Statistical Analysis:<a class="headerlink" href="#statistical-analysis" title="Link to this heading">#</a></h2>
<p>To assess the effectiveness of these medicines, an ANOVA test will be performed on the ΔCortisol values to compare the means across the four groups. If the ANOVA indicates significant differences, post-hoc tests will identify the specific groups between which these differences occur. This approach allows for a comprehensive analysis of how each medicine affects cortisol levels compared to the placebo, providing insights into their relative effectiveness and guiding cost-effectiveness considerations.</p>
</section>
<section id="brief-description-of-the-test-for-cortisol-levels">
<h2>Brief Description of the Test for Cortisol Levels:<a class="headerlink" href="#brief-description-of-the-test-for-cortisol-levels" title="Link to this heading">#</a></h2>
<p>The test involves:</p>
<ol class="arabic simple">
<li><p><strong>Collecting Baseline Data:</strong> Measuring cortisol levels before the intervention provides a baseline against which the post-treatment effects can be measured.</p></li>
<li><p><strong>Intervention:</strong> Administering the medicines or placebo over a specified period.</p></li>
<li><p><strong>Post-Treatment Measurement:</strong> Measuring cortisol levels after the treatment period to assess changes from the baseline.</p></li>
<li><p><strong>Analysis:</strong> Calculating the change in cortisol levels for each participant and using statistical methods to compare these changes across groups, thus evaluating the effectiveness of the medicines in reducing stress levels as indicated by cortisol measurements.</p></li>
</ol>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="data-generation-in-python">
<h1>Data generation in Python<a class="headerlink" href="#data-generation-in-python" title="Link to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="c1"># Generating baseline and post-treatment cortisol levels (ng/mL)</span>
<span class="n">baseline_cortisol</span> <span class="o">=</span> <span class="mi">250</span>  <span class="c1"># Assuming an average baseline cortisol level for all participants</span>
<span class="n">std_dev_baseline</span> <span class="o">=</span> <span class="mi">25</span>  <span class="c1"># Standard deviation for baseline cortisol levels</span>

<span class="c1"># Hypothetical costs (arbitrary units) reflecting effectiveness</span>
<span class="n">costs</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;Medicine A&#39;</span><span class="p">:</span> <span class="mi">100</span><span class="p">,</span>  <span class="c1"># Most effective and expensive</span>
    <span class="s1">&#39;Medicine B&#39;</span><span class="p">:</span> <span class="mi">90</span><span class="p">,</span>  <span class="c1"># As effective as A but slightly cheaper</span>
    <span class="s1">&#39;Medicine C&#39;</span><span class="p">:</span> <span class="mi">70</span><span class="p">,</span>  <span class="c1"># Moderately effective</span>
    <span class="s1">&#39;Placebo&#39;</span><span class="p">:</span> <span class="mi">2</span>      <span class="c1"># Minimal cost</span>
<span class="p">}</span>

<span class="c1"># Adjusted effectiveness in terms of reduction in cortisol levels</span>
<span class="n">effectiveness</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;Placebo&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">5</span><span class="p">,</span>  <span class="c1"># Minimal increase to simulate no real change</span>
    <span class="s1">&#39;Medicine A&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">50</span><span class="p">,</span>  <span class="c1"># Significant reduction</span>
    <span class="s1">&#39;Medicine B&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">50</span><span class="p">,</span>  <span class="c1"># Significant reduction</span>
    <span class="s1">&#39;Medicine C&#39;</span><span class="p">:</span> <span class="o">-</span><span class="mi">30</span>  <span class="c1"># Moderate reduction</span>
<span class="p">}</span>

<span class="c1"># Generate synthetic cortisol data</span>
<span class="n">cortisol_data</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">group</span><span class="p">,</span> <span class="n">reduction</span> <span class="ow">in</span> <span class="n">effectiveness</span><span class="o">.</span><span class="n">items</span><span class="p">():</span>
    <span class="n">baseline_levels</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">baseline_cortisol</span><span class="p">,</span> <span class="n">std_dev_baseline</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>  <span class="c1"># 8 participants</span>
    <span class="n">post_treatment_levels</span> <span class="o">=</span> <span class="n">baseline_levels</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">normal</span><span class="p">(</span><span class="n">reduction</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">8</span><span class="p">)</span>  <span class="c1"># Adding variability to the reduction</span>
    <span class="k">for</span> <span class="n">baseline</span><span class="p">,</span> <span class="n">post_treatment</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">baseline_levels</span><span class="p">,</span> <span class="n">post_treatment_levels</span><span class="p">):</span>
        <span class="n">cortisol_data</span><span class="o">.</span><span class="n">append</span><span class="p">({</span>
            <span class="s1">&#39;Group&#39;</span><span class="p">:</span> <span class="n">group</span><span class="p">,</span>
            <span class="s1">&#39;Baseline Cortisol (ng/mL)&#39;</span><span class="p">:</span> <span class="n">baseline</span><span class="p">,</span>
            <span class="s1">&#39;Post-Treatment Cortisol (ng/mL)&#39;</span><span class="p">:</span> <span class="n">post_treatment</span><span class="p">,</span>
            <span class="s1">&#39;ΔCortisol&#39;</span><span class="p">:</span> <span class="n">post_treatment</span> <span class="o">-</span> <span class="n">baseline</span>
        <span class="p">})</span>

<span class="n">cortisol_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">cortisol_data</span><span class="p">)</span>

<span class="n">cortisol_df</span><span class="p">[</span><span class="s1">&#39;Cost&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">cortisol_df</span><span class="p">[</span><span class="s1">&#39;Group&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">costs</span><span class="p">)</span>

<span class="n">cortisol_df</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Group</th>
      <th>Baseline Cortisol (ng/mL)</th>
      <th>Post-Treatment Cortisol (ng/mL)</th>
      <th>ΔCortisol</th>
      <th>Cost</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Placebo</td>
      <td>261.540264</td>
      <td>242.954103</td>
      <td>-18.586161</td>
      <td>2</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Placebo</td>
      <td>278.570432</td>
      <td>275.597397</td>
      <td>-2.973036</td>
      <td>2</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Placebo</td>
      <td>285.657993</td>
      <td>279.774961</td>
      <td>-5.883031</td>
      <td>2</td>
    </tr>
    <tr>
      <th>3</th>
      <td>Placebo</td>
      <td>258.531454</td>
      <td>251.651144</td>
      <td>-6.880310</td>
      <td>2</td>
    </tr>
    <tr>
      <th>4</th>
      <td>Placebo</td>
      <td>253.249566</td>
      <td>234.651226</td>
      <td>-18.598340</td>
      <td>2</td>
    </tr>
    <tr>
      <th>5</th>
      <td>Placebo</td>
      <td>294.744664</td>
      <td>289.729177</td>
      <td>-5.015487</td>
      <td>2</td>
    </tr>
    <tr>
      <th>6</th>
      <td>Placebo</td>
      <td>257.347253</td>
      <td>257.769414</td>
      <td>0.422161</td>
      <td>2</td>
    </tr>
    <tr>
      <th>7</th>
      <td>Placebo</td>
      <td>239.341232</td>
      <td>235.819004</td>
      <td>-3.522227</td>
      <td>2</td>
    </tr>
    <tr>
      <th>8</th>
      <td>Medicine A</td>
      <td>275.831706</td>
      <td>218.150687</td>
      <td>-57.681019</td>
      <td>100</td>
    </tr>
    <tr>
      <th>9</th>
      <td>Medicine A</td>
      <td>254.077941</td>
      <td>206.519614</td>
      <td>-47.558326</td>
      <td>100</td>
    </tr>
    <tr>
      <th>10</th>
      <td>Medicine A</td>
      <td>281.136112</td>
      <td>242.029149</td>
      <td>-39.106962</td>
      <td>100</td>
    </tr>
    <tr>
      <th>11</th>
      <td>Medicine A</td>
      <td>257.325441</td>
      <td>217.018546</td>
      <td>-40.306895</td>
      <td>100</td>
    </tr>
    <tr>
      <th>12</th>
      <td>Medicine A</td>
      <td>199.347581</td>
      <td>163.806394</td>
      <td>-35.541187</td>
      <td>100</td>
    </tr>
    <tr>
      <th>13</th>
      <td>Medicine A</td>
      <td>228.073187</td>
      <td>186.259257</td>
      <td>-41.813930</td>
      <td>100</td>
    </tr>
    <tr>
      <th>14</th>
      <td>Medicine A</td>
      <td>253.863343</td>
      <td>202.138651</td>
      <td>-51.724692</td>
      <td>100</td>
    </tr>
    <tr>
      <th>15</th>
      <td>Medicine A</td>
      <td>259.502454</td>
      <td>205.210015</td>
      <td>-54.292440</td>
      <td>100</td>
    </tr>
    <tr>
      <th>16</th>
      <td>Medicine B</td>
      <td>269.044647</td>
      <td>213.966897</td>
      <td>-55.077751</td>
      <td>90</td>
    </tr>
    <tr>
      <th>17</th>
      <td>Medicine B</td>
      <td>269.840402</td>
      <td>208.051949</td>
      <td>-61.788453</td>
      <td>90</td>
    </tr>
    <tr>
      <th>18</th>
      <td>Medicine B</td>
      <td>295.200977</td>
      <td>241.991357</td>
      <td>-53.209619</td>
      <td>90</td>
    </tr>
    <tr>
      <th>19</th>
      <td>Medicine B</td>
      <td>273.874287</td>
      <td>217.017507</td>
      <td>-56.856779</td>
      <td>90</td>
    </tr>
    <tr>
      <th>20</th>
      <td>Medicine B</td>
      <td>254.763493</td>
      <td>206.117891</td>
      <td>-48.645602</td>
      <td>90</td>
    </tr>
    <tr>
      <th>21</th>
      <td>Medicine B</td>
      <td>252.364012</td>
      <td>179.428393</td>
      <td>-72.935619</td>
      <td>90</td>
    </tr>
    <tr>
      <th>22</th>
      <td>Medicine B</td>
      <td>213.096589</td>
      <td>161.061671</td>
      <td>-52.034918</td>
      <td>90</td>
    </tr>
    <tr>
      <th>23</th>
      <td>Medicine B</td>
      <td>245.044383</td>
      <td>190.257131</td>
      <td>-54.787251</td>
      <td>90</td>
    </tr>
    <tr>
      <th>24</th>
      <td>Medicine C</td>
      <td>280.763885</td>
      <td>244.856592</td>
      <td>-35.907293</td>
      <td>70</td>
    </tr>
    <tr>
      <th>25</th>
      <td>Medicine C</td>
      <td>227.545990</td>
      <td>194.838657</td>
      <td>-32.707333</td>
      <td>70</td>
    </tr>
    <tr>
      <th>26</th>
      <td>Medicine C</td>
      <td>294.041334</td>
      <td>269.834163</td>
      <td>-24.207171</td>
      <td>70</td>
    </tr>
    <tr>
      <th>27</th>
      <td>Medicine C</td>
      <td>239.576868</td>
      <td>210.393480</td>
      <td>-29.183388</td>
      <td>70</td>
    </tr>
    <tr>
      <th>28</th>
      <td>Medicine C</td>
      <td>292.311344</td>
      <td>263.066168</td>
      <td>-29.245176</td>
      <td>70</td>
    </tr>
    <tr>
      <th>29</th>
      <td>Medicine C</td>
      <td>234.025105</td>
      <td>212.891379</td>
      <td>-21.133726</td>
      <td>70</td>
    </tr>
    <tr>
      <th>30</th>
      <td>Medicine C</td>
      <td>228.044767</td>
      <td>202.724296</td>
      <td>-25.320471</td>
      <td>70</td>
    </tr>
    <tr>
      <th>31</th>
      <td>Medicine C</td>
      <td>233.619080</td>
      <td>203.363824</td>
      <td>-30.255256</td>
      <td>70</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="example-solution">
<h1>Example solution<a class="headerlink" href="#example-solution" title="Link to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="kn">import</span> <span class="nn">plotly.express</span> <span class="k">as</span> <span class="nn">px</span>
<span class="kn">import</span> <span class="nn">statsmodels.api</span> <span class="k">as</span> <span class="nn">sm</span>
<span class="kn">from</span> <span class="nn">statsmodels.formula.api</span> <span class="kn">import</span> <span class="n">ols</span>
<span class="kn">import</span> <span class="nn">scipy.stats</span> <span class="k">as</span> <span class="nn">stats</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">ttest_rel</span>
</pre></div>
</div>
</div>
</div>
<section id="task-1-generate-pre-and-post-treatment-cortisol-levels-for-each-group">
<h2>Task 1. Generate pre- and post-treatment cortisol levels for each group.<a class="headerlink" href="#task-1-generate-pre-and-post-treatment-cortisol-levels-for-each-group" title="Link to this heading">#</a></h2>
<p>In this example we need the tool <code class="docutils literal notranslate"><span class="pre">ttest_rel</span></code> for perform paired <a class="reference external" href="https://en.wikipedia.org/wiki/Student%27s_t-test">t-test</a>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Performing paired t-tests for each group</span>
<span class="n">paired_tests_results</span> <span class="o">=</span> <span class="p">{}</span>
<span class="k">for</span> <span class="n">group</span> <span class="ow">in</span> <span class="n">cortisol_df</span><span class="p">[</span><span class="s1">&#39;Group&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">():</span>
    <span class="n">pre</span> <span class="o">=</span> <span class="n">cortisol_df</span><span class="p">[</span><span class="n">cortisol_df</span><span class="p">[</span><span class="s1">&#39;Group&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">group</span><span class="p">][</span><span class="s1">&#39;Baseline Cortisol (ng/mL)&#39;</span><span class="p">]</span>
    <span class="n">post</span> <span class="o">=</span> <span class="n">cortisol_df</span><span class="p">[</span><span class="n">cortisol_df</span><span class="p">[</span><span class="s1">&#39;Group&#39;</span><span class="p">]</span> <span class="o">==</span> <span class="n">group</span><span class="p">][</span><span class="s1">&#39;Post-Treatment Cortisol (ng/mL)&#39;</span><span class="p">]</span>
    <span class="n">t_stat</span><span class="p">,</span> <span class="n">p_value</span> <span class="o">=</span> <span class="n">ttest_rel</span><span class="p">(</span><span class="n">pre</span><span class="p">,</span> <span class="n">post</span><span class="p">)</span>
    <span class="n">paired_tests_results</span><span class="p">[</span><span class="n">group</span><span class="p">]</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;t-statistic&#39;</span><span class="p">:</span> <span class="n">t_stat</span><span class="p">,</span> <span class="s1">&#39;p-value&#39;</span><span class="p">:</span> <span class="n">p_value</span><span class="p">}</span>

<span class="k">for</span> <span class="n">trial</span> <span class="ow">in</span> <span class="n">paired_tests_results</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Group &#39;</span><span class="p">,</span> <span class="n">trial</span><span class="p">,</span> 
          <span class="s1">&#39;got a statistical value of &#39;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">paired_tests_results</span><span class="p">[</span><span class="n">trial</span><span class="p">][</span><span class="s1">&#39;t-statistic&#39;</span><span class="p">],</span><span class="mi">3</span><span class="p">),</span> 
          <span class="s1">&#39;and a p-value of &#39;</span><span class="p">,</span> <span class="nb">round</span><span class="p">(</span><span class="n">paired_tests_results</span><span class="p">[</span><span class="n">trial</span><span class="p">][</span><span class="s1">&#39;p-value&#39;</span><span class="p">],</span><span class="mi">3</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Group  Placebo got a statistical value of  3.034 and a p-value of  0.019
Group  Medicine A got a statistical value of  16.278 and a p-value of  0.0
Group  Medicine B got a statistical value of  21.451 and a p-value of  0.0
Group  Medicine C got a statistical value of  16.886 and a p-value of  0.0
</pre></div>
</div>
</div>
</div>
<ul class="simple">
<li><p><strong>Placebo Group:</strong></p>
<ul>
<li><p>T-statistic: 1.899</p></li>
<li><p>P-value: 0.099</p></li>
<li><p>These results indicate that the change in cortisol levels for the placebo group is not statistically significant, suggesting no real effect of the placebo on cortisol levels.</p></li>
</ul>
</li>
<li><p><strong>Medicine A Group:</strong></p>
<ul>
<li><p>T-statistic: 17.191</p></li>
<li><p>P-value: 0.0</p></li>
<li><p>These results suggest a highly significant reduction in cortisol levels due to Medicine A, indicating its effectiveness in substantially reducing stress as measured by cortisol levels.</p></li>
</ul>
</li>
<li><p><strong>Medicine B Group:</strong></p>
<ul>
<li><p>T-statistic: 14.61</p></li>
<li><p>P-value: 0.0</p></li>
<li><p>Similar to Medicine A, these results indicate a highly significant reduction in cortisol levels with Medicine B, confirming its effectiveness in stress reduction.</p></li>
</ul>
</li>
<li><p><strong>Medicine C Group:</strong></p>
<ul>
<li><p>T-statistic: 7.833</p></li>
<li><p>P-value: 0.0</p></li>
<li><p>These results also show a significant reduction in cortisol levels due to Medicine C, though the magnitude of change (as implied by the t-statistic) is less than that for Medicines A and B, but still indicating effectiveness.</p></li>
</ul>
</li>
</ul>
<section id="interpretation">
<h3>Interpretation:<a class="headerlink" href="#interpretation" title="Link to this heading">#</a></h3>
<p>The updated analysis clearly distinguishes the effectiveness of the medicines from the placebo:</p>
<ul class="simple">
<li><p>The <strong>Placebo group</strong> demonstrates no significant change in cortisol levels, which aligns with expectations for a placebo treatment.</p></li>
<li><p><strong>Medicine A</strong> and <strong>Medicine B</strong> both show highly significant reductions in cortisol levels, with Medicine A demonstrating a slightly higher statistical value than Medicine B. This suggests that both are highly effective in reducing stress, with Medicine A possibly having a slight edge in effectiveness.</p></li>
<li><p><strong>Medicine C</strong>, while also effective in reducing cortisol levels, shows a smaller magnitude of effect compared to Medicines A and B, as indicated by its lower t-statistic. However, the p-value of 0.0 for Medicine C still underscores its significant efficacy in reducing stress.</p></li>
</ul>
</section>
</section>
<section id="task-2-perform-a-statistical-analysis-comparing-the-change-in-cortisol-levels-across-the-four-groups">
<h2>Task 2. Perform a statistical analysis comparing the change in cortisol levels across the four groups.<a class="headerlink" href="#task-2-perform-a-statistical-analysis-comparing-the-change-in-cortisol-levels-across-the-four-groups" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sns</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">x</span><span class="o">=</span><span class="s1">&#39;Group&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;ΔCortisol&#39;</span><span class="p">,</span>  <span class="n">data</span><span class="o">=</span><span class="n">cortisol_df</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="_images/b52867f8a6ec64791a067a73e4233e97552b9ce57a62cb1ed86d886fd7dea0d6.png" src="_images/b52867f8a6ec64791a067a73e4233e97552b9ce57a62cb1ed86d886fd7dea0d6.png" />
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">model</span> <span class="o">=</span> <span class="n">ols</span><span class="p">(</span><span class="s1">&#39;ΔCortisol ~ C(Group)&#39;</span><span class="p">,</span> <span class="n">data</span><span class="o">=</span><span class="n">cortisol_df</span><span class="p">)</span><span class="o">.</span><span class="n">fit</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="n">model</span><span class="o">.</span><span class="n">summary</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                            OLS Regression Results                            
==============================================================================
Dep. Variable:              ΔCortisol   R-squared:                       0.892
Model:                            OLS   Adj. R-squared:                  0.880
Method:                 Least Squares   F-statistic:                     76.73
Date:                Sun, 11 Feb 2024   Prob (F-statistic):           1.28e-13
Time:                        19:10:01   Log-Likelihood:                -105.34
No. Observations:                  32   AIC:                             218.7
Df Residuals:                      28   BIC:                             224.5
Df Model:                           3                                         
Covariance Type:            nonrobust                                         
==========================================================================================
                             coef    std err          t      P&gt;|t|      [0.025      0.975]
------------------------------------------------------------------------------------------
Intercept                -46.0032      2.460    -18.703      0.000     -51.042     -40.965
C(Group)[T.Medicine B]   -10.9138      3.478     -3.138      0.004     -18.039      -3.789
C(Group)[T.Medicine C]    17.5082      3.478      5.033      0.000      10.383      24.633
C(Group)[T.Placebo]       38.3736      3.478     11.032      0.000      31.248      45.499
==============================================================================
Omnibus:                        2.981   Durbin-Watson:                   2.106
Prob(Omnibus):                  0.225   Jarque-Bera (JB):                2.622
Skew:                          -0.680   Prob(JB):                        0.270
Kurtosis:                       2.657   Cond. No.                         4.79
==============================================================================

Notes:
[1] Standard Errors assume that the covariance matrix of the errors is correctly specified.
</pre></div>
</div>
</div>
</div>
<section id="model-summary">
<h3>Model Summary:<a class="headerlink" href="#model-summary" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><strong>R-squared:</strong> 0.795 - This indicates that approximately 79.5% of the variability in the change in cortisol levels can be explained by the differences in treatment groups. It’s a measure of the model’s goodness of fit.</p></li>
<li><p><strong>Adjusted R-squared:</strong> 0.773 - Adjusted for the number of predictors in the model, which provides a more accurate measure when comparing models with a different number of independent variables.</p></li>
<li><p><strong>F-statistic:</strong> 36.16 with a <strong>Prob (F-statistic)</strong> of 9.11e-10 - This suggests that the overall model is statistically significant, meaning there is a significant difference in cortisol changes among the different groups.</p></li>
<li><p><strong>No. Observations:</strong> 32 - The total number of participants or observations included in the analysis.</p></li>
<li><p><strong>Df Residuals:</strong> 28 - Degrees of freedom of the residuals, calculated as the number of observations minus the number of parameters being estimated.</p></li>
<li><p><strong>Df Model:</strong> 3 - The number of independent variables or predictors in the model.</p></li>
<li><p><strong>AIC:</strong> 239.0 and <strong>BIC:</strong> 244.9 - These are information criteria used to compare models, with lower values indicating a better fit.</p></li>
</ul>
</section>
<section id="coefficients">
<h3>Coefficients:<a class="headerlink" href="#coefficients" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><strong>Intercept (Medicine A baseline):</strong> -47.7040 - This coefficient represents the baseline change in cortisol levels for Medicine A (since it’s the omitted group in dummy coding), with a highly significant p-value indicating a substantial decrease in cortisol levels associated with Medicine A.</p></li>
<li><p><strong>C(Group)[T.Medicine B]:</strong> -3.0629 - This coefficient shows the difference in the change of cortisol levels between Medicine B and Medicine A. The negative sign suggests a decrease, but the p-value of 0.527 indicates this difference is not statistically significant.</p></li>
<li><p><strong>C(Group)[T.Medicine C]:</strong> 20.2907 - Indicates that Medicine C, on average, leads to an increase in cortisol reduction compared to Medicine A by about 20.29 units, with a significant p-value of 0.000, suggesting a substantial difference.</p></li>
<li><p><strong>C(Group)[T.Placebo]:</strong> 40.6936 - Suggests an even larger average increase in cortisol reduction for the Placebo group compared to Medicine A by about 40.69 units, with a highly significant p-value of 0.000.</p></li>
</ul>
</section>
<section id="diagnostics">
<h3>Diagnostics:<a class="headerlink" href="#diagnostics" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><strong>Omnibus/Prob(Omnibus):</strong> Tests the hypothesis that the residuals are normally distributed. The Omnibus test statistic is 1.962 with a p-value of 0.375, suggesting no significant deviation from normality.</p></li>
<li><p><strong>Skew:</strong> -0.536 - A measure of the symmetry of the data distribution. A value closer to 0 indicates more symmetry.</p></li>
<li><p><strong>Kurtosis:</strong> 2.788 - Measures the “tailedness” of the distribution. A value close to 3 (which represents normal distribution) indicates the residuals are fairly normally distributed.</p></li>
<li><p><strong>Durbin-Watson:</strong> 1.737 - A test for autocorrelation in the residuals. Values close to 2 suggest there is no autocorrelation.</p></li>
</ul>
<p>The analysis reveals a significant effect of treatment on cortisol levels, with Medicine A showing a considerable decrease in cortisol levels as the reference group. The lack of a significant difference between Medicines A and B suggests similar efficacy, whereas Medicine C and the Placebo group show statistically significant differences in effect compared to Medicine A. Notably, the model suggests that being in the Placebo group is associated with a significant increase in cortisol reduction compared to Medicine A, which might require further investigation to understand any potential biases or other factors influencing this outcome.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">anova_table</span> <span class="o">=</span> <span class="n">sm</span><span class="o">.</span><span class="n">stats</span><span class="o">.</span><span class="n">anova_lm</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">typ</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">anova_table</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>                sum_sq    df          F        PR(&gt;F)
C(Group)  11141.226819   3.0  76.732826  1.278110e-13
Residual   1355.153843  28.0        NaN           NaN
</pre></div>
</div>
</div>
</div>
<p>The ANOVA results indicate a highly significant difference in the change in cortisol levels across the different treatment groups (C(Group)), with an F-statistic of 36.163031 and an extremely small p-value (9.110841e-10), meaning we can reject the null hypothesis that there is no difference in the mean change in cortisol levels among the groups, suggesting that the type of treatment significantly affects cortisol reduction.</p>
<p>The significant F-statistic points to the effectiveness of the treatment modalities in altering cortisol levels, warranting further investigation into pairwise comparisons among the groups to identify specific differences (a.k.a., post hoc analysis). This analysis underscores the importance of the treatment effect on stress reduction as measured by changes in cortisol levels. The table presents the ANOVA (Analysis of Variance) summary, which is used to compare the means of the change in cortisol levels (ΔCortisol) across different treatment groups (C(Group)). Here’s a breakdown of the table’s components:</p>
</section>
<section id="components">
<h3>Components:<a class="headerlink" href="#components" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><strong>sum_sq (Sum of Squares):</strong> This measures the total variation in the dependent variable (ΔCortisol) that is explained by the model (C(Group)) and the unexplained variation (Residual).</p>
<ul>
<li><p><strong>C(Group) sum_sq:</strong> 9906.748399 - This is the between-group variation that quantifies how much of the total variation in ΔCortisol can be attributed to the difference between the treatment groups.</p></li>
<li><p><strong>Residual sum_sq:</strong> 2556.837236 - This is the within-group variation, also known as the error or unexplained variation, which measures the variation in ΔCortisol within each group that is not explained by the group differences.</p></li>
</ul>
</li>
<li><p><strong>df (Degrees of Freedom):</strong></p>
<ul>
<li><p>For <strong>C(Group):</strong> 3.0 - This represents the number of treatment groups minus one (4 groups - 1).</p></li>
<li><p>For <strong>Residual:</strong> 28.0 - This is calculated as the total number of observations minus the number of groups (32 observations - 4 groups).</p></li>
</ul>
</li>
<li><p><strong>F (F-statistic):</strong> 36.163031 - This is the ratio of the model mean square (sum_sq for C(Group) divided by its df) to the residual mean square (sum_sq for Residual divided by its df). It is used to test the hypothesis that all group means are equal. A higher F-statistic indicates a greater probability that there are significant differences among group means.</p></li>
<li><p><strong>PR(&gt;F) (P-value for the F-statistic):</strong> 9.110841e-10 - This is the probability of observing the calculated F-statistic, or one more extreme, under the assumption that the null hypothesis is true (i.e., all group means are equal). A small p-value (typically &lt;0.05) suggests that the observed data are unlikely under the null hypothesis, leading to its rejection in favor of the alternative hypothesis that not all group means are equal.</p></li>
</ul>
</section>
</section>
<section id="task-3-conduct-a-cost-effectiveness-analysis-based-on-the-change-in-cortisol-levels-and-the-cost-of-each-medicine">
<h2>Task 3. Conduct a cost-effectiveness analysis based on the change in cortisol levels and the cost of each medicine.<a class="headerlink" href="#task-3-conduct-a-cost-effectiveness-analysis-based-on-the-change-in-cortisol-levels-and-the-cost-of-each-medicine" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Calculating average ΔCortisol for each group</span>
<span class="n">average_delta_cortisol</span> <span class="o">=</span> <span class="n">cortisol_df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Group&#39;</span><span class="p">)[</span><span class="s1">&#39;ΔCortisol&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>

<span class="c1"># Calculating cost per unit of cortisol reduction for each group</span>
<span class="n">cost_per_unit_reduction</span> <span class="o">=</span> <span class="n">cortisol_df</span><span class="o">.</span><span class="n">groupby</span><span class="p">(</span><span class="s1">&#39;Group&#39;</span><span class="p">)[</span><span class="s1">&#39;Cost&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span> <span class="o">/</span> <span class="nb">abs</span><span class="p">(</span><span class="n">average_delta_cortisol</span><span class="p">)</span>

<span class="c1"># Displaying the results</span>
<span class="n">average_delta_cortisol</span><span class="p">,</span> <span class="n">cost_per_unit_reduction</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>(Group
 Medicine A   -46.003182
 Medicine B   -56.916999
 Medicine C   -28.494977
 Placebo       -7.629554
 Name: ΔCortisol, dtype: float64,
 Group
 Medicine A    2.173763
 Medicine B    1.581250
 Medicine C    2.456573
 Placebo       0.262139
 dtype: float64)
</pre></div>
</div>
</div>
</div>
<p>The formula for cost-effectiveness will be:
$<span class="math notranslate nohighlight">\(CostPerUnitOfCortisolReduction = Cost / |Average ΔCortisol|\)</span>$</p>
<section id="average-change-in-cortisol-levels-cortisol">
<h3>Average Change in Cortisol Levels (ΔCortisol):<a class="headerlink" href="#average-change-in-cortisol-levels-cortisol" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><strong>Medicine A:</strong> -47.70 ng/mL</p></li>
<li><p><strong>Medicine B:</strong> -50.77 ng/mL</p></li>
<li><p><strong>Medicine C:</strong> -27.41 ng/mL</p></li>
<li><p><strong>Placebo:</strong> -7.01 ng/mL</p></li>
</ul>
</section>
<section id="cost-per-unit-of-cortisol-reduction">
<h3>Cost per Unit of Cortisol Reduction:<a class="headerlink" href="#cost-per-unit-of-cortisol-reduction" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><strong>Medicine A:</strong> 2.10 (Cost per ng/mL of cortisol reduction)</p></li>
<li><p><strong>Medicine B:</strong> 1.77 (Cost per ng/mL of cortisol reduction)</p></li>
<li><p><strong>Medicine C:</strong> 2.55 (Cost per ng/mL of cortisol reduction)</p></li>
<li><p><strong>Placebo:</strong> 0.29 (Cost per ng/mL of cortisol reduction)</p></li>
</ul>
</section>
<section id="id1">
<h3>Interpretation:<a class="headerlink" href="#id1" title="Link to this heading">#</a></h3>
<ul class="simple">
<li><p><strong>Medicine A and B</strong> effectively reduce cortisol levels. Medicine B is slightly more cost-effective than Medicine A based on the cortisol reduction cost per unit.</p></li>
<li><p><strong>Medicine C</strong> shows a moderate reduction in cortisol levels and is less cost-effective than Medicines A and B when considering the cost per unit of cortisol reduction.
<strong>Placebo</strong> shows the least reduction in cortisol levels, as expected, but it has the lowest cost per unit of cortisol reduction. This low cost per unit reflects minimal effectiveness rather than economic efficiency.</p></li>
</ul>
<p>In conclusion, while <strong>Medicine B</strong> provides the most cost-effective solution among the treatments for reducing cortisol levels, <strong>Medicine A</strong> is also very effective but at a slightly higher cost per unit of cortisol reduction. <strong>Medicine C</strong>, though less effective than A and B, still offers a significant reduction in cortisol levels but at a higher cost per unit of effectiveness compared to Medicine B. The <strong>Placebo</strong> group, naturally, shows minimal effectiveness, and its cost-effectiveness ratio is not a relevant measure due to its lack of therapeutic effect.</p>
</section>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="note">
<h1>Note.<a class="headerlink" href="#note" title="Link to this heading">#</a></h1>
<p>After analyzing a randomly generated dataset, please note that replication of the data frame will result in a different value, but the analysis process remains the same.</p>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./."
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer">
                  
<div class="prev-next-area">
    <a class="left-prev"
       href="01-one-way-anova.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Explaining the Python Code</p>
      </div>
    </a>
    <a class="right-next"
       href="02-markdown.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Markdown Files</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">ANOVA One-way: An Illustrative example</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#brief-description-of-the-test">Brief Description of the Test:</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#data">Data:</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#statistical-analysis">Statistical Analysis:</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#brief-description-of-the-test-for-cortisol-levels">Brief Description of the Test for Cortisol Levels:</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#data-generation-in-python">Data generation in Python</a></li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#example-solution">Example solution</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#task-1-generate-pre-and-post-treatment-cortisol-levels-for-each-group">Task 1. Generate pre- and post-treatment cortisol levels for each group.</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#interpretation">Interpretation:</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#task-2-perform-a-statistical-analysis-comparing-the-change-in-cortisol-levels-across-the-four-groups">Task 2. Perform a statistical analysis comparing the change in cortisol levels across the four groups.</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#model-summary">Model Summary:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#coefficients">Coefficients:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#diagnostics">Diagnostics:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#components">Components:</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#task-3-conduct-a-cost-effectiveness-analysis-based-on-the-change-in-cortisol-levels-and-the-cost-of-each-medicine">Task 3. Conduct a cost-effectiveness analysis based on the change in cortisol levels and the cost of each medicine.</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#average-change-in-cortisol-levels-cortisol">Average Change in Cortisol Levels (ΔCortisol):</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#cost-per-unit-of-cortisol-reduction">Cost per Unit of Cortisol Reduction:</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#id1">Interpretation:</a></li>
</ul>
</li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#note">Note.</a></li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Leonardo H. Talero-Sarmiento, Henry Lamos-Diaz, Juan D. Marquez-Gonzalez
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="_static/scripts/bootstrap.js?digest=8d27b9dea8ad943066ae"></script>
<script src="_static/scripts/pydata-sphinx-theme.js?digest=8d27b9dea8ad943066ae"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>